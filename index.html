<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7 at 2016-03-07 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160307" />
    <meta http-equiv="Content-Language" content="en" />
    <title>SPARQL Generate over Apache Jena &#x2013; What is SPARQL-Generate ?</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/thesmartenergy/sparql-generate-jena">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://itea3.org/project/seas.html" id="bannerLeft">
                                                                                        <img src="http://the-smart-energy.com/content/themes/xxi/img/logo.png"  alt="ITEA 12004 SEAS Project"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="publishDate">Last Published: 2016-03-07
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 0.9
                      </li>
                      
              
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                              
      <li class="active">
  
            <a href="#"><span class="none"></span>Introduction</a>
          </li>
                
      <li>
  
                          <a href="examples.html" title="Examples">
          <span class="none"></span>
        Examples</a>
            </li>
                
      <li>
  
                          <a href="http://ci.emse.fr/sparql-generate/" class="externalLink" title="Specification">
          <span class="none"></span>
        Specification</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                          
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                  
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
              
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="http://github.com/thesmartenergy/sparql-generate-jena" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://cse.google.com/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>What is SPARQL-Generate ?</h1>
<p>SPARQL-Generate stands for SPARQL-Generate Protocol and RDF Generation Language. The aim of SPARQL-Generate <tt>GENERATE</tt> queries is to offer a simple template-based option to interpret any document as proper RDF, with a well defined semantics grounded on the SPARQL 1.1. </p>
<div class="section">
<h2><a name="Specification"></a>Specification</h2>
<p>The complete specification (will be) available here: <a class="externalLink" href="http://w3id.org/sparql-generate">http://w3id.org/sparql-generate</a>.</p>
<p>In the meantime, you can subscribe to the mailing list: <a class="externalLink" href="https://groups.google.com/forum/#!forum/sparql-generate-jena">https://groups.google.com/forum/#!forum/sparql-generate-jena</a>.</p></div>
<div class="section">
<h2><a name="What_use_cases_for_SPARQL-Generate_"></a>What use cases for SPARQL-Generate ?</h2>
<p>SPARQL-Generate is already in use for the following use cases:</p>

<ul>
  
<li>Give ways to interpret JSON or even CBOR documents as RDF (ongoing work in the ITEA 2 SEAS project: serve the consumption data of the GECAD microgrid as CBOR, and point to the SPARQL-Generate <tt>GENERATE</tt> query that enables to interpret it as RDF. More generally, any kind of document, XML, JSON, CBOR, can be interpreted as RDF using the proper SPARQL-Generate <tt>GENERATE</tt> query with proper <i>iterator functions</i>)</li>
  
<li>Generate a whole part of a vocabulary from a configuration file, and ensure that specific naming conventions are respected for resource URIs, labels and comments (ongoing work in the ITEA 2 SEAS project: the ontology of Multi-Dimensional Quantities, is parametrized and generated from JSON configuration files);</li>
  
<li>generate RDF from several open data sources (ongoing work in the OpenSensingCity French ANR project)</li>
</ul>
<h1>The RDF Generation Language</h1>
<p>The RDF Generation Language part of SPARQL-Generate extends the SPARQL 1.1 Query language, and offers a simple template-based RDF Graph generation from RDF literals. </p>
<p>Other languages enable to describe mapping from documents to RDF. By design, SPARQL-Generate extends SPARQL and hence offers an alternative that presents the following advantages:</p>

<ul>
  
<li>anyone familiar with SPARQL can easily learn SPARQL-Generate;</li>
  
<li>implementing over existing SPARQL engines is simple;</li>
  
<li>SPARQL-Generate leverages the expressivity of SPARQL 1.1: Aggregates, Solution Sequences and Modifiers, SPARQL functions and their extension mechanism.</li>
</ul>
<p>SPARQL-Generate <tt>GENERATE</tt> extends the SPARQL 1.1 recommendation with the following keywords:</p></div>
<div class="section">
<h2><a name="General_form_of_a_SPARQL_Generate_Query"></a>General form of a SPARQL Generate Query</h2>
<p>The general structure of a SPARQL-Generate query is as follows:</p>

<div class="source">
<div class="source"><pre class="prettyprint">PREFIX declarations            -- same as SPARQL 1.1
GENERATE template              -- replaces and extends SPARQL 1.1 CONSTRUCT
FROM and FROM NAMED clauses    -- same as SPARQL 1.1
ITERATOR and SOURCE clauses    -- see below
WHERE clause                   -- same as SPARQL 1.1
Solution modifiers              -- group by, order by, limit, offset,... same as SPARQL 1.1
</pre></div></div></div>
<div class="section">
<h2><a name="ITERATOR_clause"></a><tt>ITERATOR</tt> clause</h2>
<p>The <tt>ITERATOR</tt> clause uses the concept of SPARQL-Generate <i>iterator function</i>. A SPARQL-Generate <i>iterator</i> is similar to a SPARQL 1.1 Function, except it <i>returns a list of RDF Terms</i> instead of just one. The syntax of the <tt>ITERATOR</tt>clause is the following:</p>

<div class="source">
<div class="source"><pre class="prettyprint">where `&lt;iterator&gt;` is the IRI of the SPARQL-Generate *iterator function*. As the name `ITERATOR` suggests, `?var`will be bound to every RDF Term in the list returned by the evaluation of the iterator function over the arguments `args`.

As a simple example, consider the JSON message:

</pre></div></div>
<p>{ &#x201c;firstname&#x201d; : &#x201c;Maxime&#x201d; ,  &#x201c;lastname&#x201d; : &#x201c;Lefrancois&#x201d; ,  &#x201c;birthday&#x201d; : &#x201c;04-26&#x201d; ,  &#x201c;country&#x201d; : &#x201c;FR&#x201d; , } ``<tt>
If this message is bound to variable</tt>?doc`, then the following SPARQL-Generate query:</p>

<div class="source">
<div class="source"><pre class="prettyprint">BASE &lt;http://example.org/&gt;
GENERATE 
  { &lt;&gt; ?p ?o . }
ITERATOR &lt;http://w3id.org/sparql-generate/ite/JSONListKeys&gt;(?doc) AS ?key
WHERE
  { 
    BIND( uri( ?key ) AS ?p )
    BIND( &lt;http://w3id.org/sparql-generate/fn/JSONPath&gt; ( ?doc, CONCAT( &quot;$.&quot; , ?key ) ) AS ?o )
  }
</pre></div></div>
<p>Then one retrieve the following RDF Graph (serialized here in Turtle):</p>

<div class="source">
<div class="source"><pre class="prettyprint">@base &lt;http://example.org/&gt; .
&lt;&gt;      &lt;firstname&gt; &quot;Maxime&quot; ;
        &lt;lastname&gt;  &quot;Lefrancois&quot; ;
        &lt;birthday&gt;  &quot;04/26&quot; ;
        &lt;country&gt;   &quot;FR&quot; .
</pre></div></div></div>
<div class="section">
<h2><a name="SOURCE_clause"></a><tt>SOURCE</tt> clause</h2>
<p>The <tt>SOURCE</tt> clause enables to fetch a web document, and to bind it as a RDF Literal to a variable. Its syntax is as follows:</p>

<div class="source">
<div class="source"><pre class="prettyprint">SOURCE &lt;source&gt; ACCEPT &lt;iana urn&gt; AS ?var
</pre></div></div>
<p>If <tt>&lt;source&gt;</tt> is a HTTP IRI, then the engine will operate a HTTP GET to that IRI (or use a local cache), then bind variable <tt>?var</tt> to the RDF Literal representation of the retrieved document. </p>
<p><tt>ACCEPT &lt;iana urn&gt;</tt> is optional. If set, it must be a IANA MIME URN. For instance: <tt>&lt;urn:iana:mime:application/json&gt;</tt>. It tells the engine which Accept Header field to use when operating the GET.</p>
<p>The RDF Literal representation of the retrieved document is as follows:</p>

<ul>
  
<li>its lexical form is a Unicode representation of the payload.</li>
  
<li>its datatype IRI is a IANA MIME URN, based on the internet media type of the retrieved document, or <tt>xsd:string</tt> if the Content-Type is not defined in the response. For instance, if the mime type is &#x201c;application/vcard+json&#x201d;. Then the datatype IRI will be <tt>&lt;urn:iana:mime:application:vcard+json&gt;</tt>.</li>
</ul>
<p>For example, the following SPARQL-Generate query retrieves the document at URL <tt>&lt;http://country.io/capital.json&gt;</tt>, then generates a little RDF description of the country code and the capital name of the two first countries whose code starts with an &#x2018;F&#x2019;.</p>

<div class="source">
<div class="source"><pre class="prettyprint">BASE &lt;http://example.org/&gt; 
GENERATE { 
  [] a &lt;Country&gt; ;
    &lt;key&gt; ?key ;
    &lt;capital&gt; ?capital.
}
SOURCE &lt;http://country.io/capital.json&gt; AS ?source
ITERATOR &lt;http://w3id.org/sparql-generate/ite/JSONListKeys&gt;(?source) AS ?key
WHERE {
   FILTER( STRSTARTS(?key,&quot;F&quot;) )
   BIND( CONCAT('$.', ?key) AS ?query )
   BIND( &lt;http://w3id.org/sparql-generate/fn/JSONPath&gt;(?source, ?query ) AS ?capital )
}
ORDER BY ?key
LIMIT 2
</pre></div></div>
<p>It generates the following RDF Graph:</p>

<div class="source">
<div class="source"><pre class="prettyprint">@base &lt;http://example.org/&gt; .
[] a          &lt;Country&gt; ;
   &lt;capital&gt;  &quot;Suva&quot; ;
   &lt;code&gt;     &quot;FJ&quot; .
[] a  &lt;Country&gt; ;
   &lt;capital&gt;  &quot;Stanley&quot; ;
   &lt;code&gt;     &quot;FK&quot; .
[] a          &lt;Country&gt; ;
   &lt;capital&gt;  &quot;Helsinki&quot; ;
   &lt;code&gt;     &quot;FI&quot; .
</pre></div></div></div>
<div class="section">
<h2><a name="sub-GENERATE_queries"></a>sub-<tt>GENERATE</tt> queries</h2>
<p>One may embed other GENERATE queries in the <tt>GENERATE</tt> template. The <tt>GENERATE</tt> part of the embedded query may be a template as above, or just a URI that indicates the engine that it must fetch and execute an existing query on the web, with the current binding solutions. For instance, the following example </p></div>
<div class="section">
<h2><a name="How_it_works"></a>How it works</h2>
<p>The execution of a SPARQL Generate is roughly defined as follows:</p>

<ol style="list-style-type: decimal">
  
<li>clauses <tt>ITERATOR</tt> and <tt>SOURCE</tt> are processed in order, and one constructs a [https://www.w3.org/TR/sparql11-query/#inline-data](SPARQL 1.1 VALUES) data block.</li>
  
<li>one constructs a SPARQL 1.1 <tt>SELECT *</tt> query from the SPARQL Generate query, and add the data block at the beginning of the WHERE clause.</li>
  
<li>this SPARQL 1.1 SELECT query is evaluated on the SPARQL dataset, and produces a set of solution bindings.</li>
  
<li>for each of these solution bindings, and for each element in the GENERATE template, one either produce triples, or execute the embedded query.</li>
</ol>
<h1>The Protocol</h1>
<p>The protocol part of SPARQL-Generate enables a web client or a web server to point to the URL of a SPARQL-Generate document that may be used to interpret the request (or the response) payload as RDF.</p></div>
<div class="section">
<h2><a name="aHow_you_server_should_interpret_my_lightweight_HTTP_request_payload_as_RDF"></a>&#x201c;How you, server, should interpret my lightweight HTTP request payload as RDF&#x201d;</h2>
<p>For HTTP requests, SPARQL-Generate defines Header Field X-SPARQL-Generate-Companion, If the server is RDF-enabled, it can use the value of this header field (a URL), to retrieve a SPARQL-Generate document, and interpret the input as RDF. An example of such a HTTP Request Header field:</p>

<div class="source">
<div class="source"><pre class="prettyprint">SPARQL-Generate-Companion: &lt;http://manufacturer.com/deviceX/sparql-gen&gt;
</pre></div></div></div>
<div class="section">
<h2><a name="aHow_you_client_should_interpret_my_lightweight_HTTP_resonse_payload_as_RDF"></a>&#x201c;How you, client, should interpret my lightweight HTTP resonse payload as RDF&#x201d;</h2>
<p>For HTTP responses, the server may use the web-link relation type defined by SPARQL-Generate, <a class="externalLink" href="http://w3id.org/sparql-generate/companion">http://w3id.org/sparql-generate/companion</a>, with the document as anchor, and the URL where one should be able to retrieve a SPARQL-Generate document as source. If the client is RDF-enabled, it can use this SPARQL Generate query to interpret the output as RDF. An example of such a web-link in a HTTP Response Header field:</p>

<div class="source">
<div class="source"><pre class="prettyprint">Link: &lt;http://manufacturer.com/deviceX/sparql-gen&gt;; rel=&quot;http://w3id.org/sparql-generate/companion&quot;
</pre></div></div></div>
<div class="section">
<h2><a name="IANA_considerations."></a>IANA considerations.</h2>
<p>The Internet Media type of a SPARQL-Generate query is <tt>application/sparql-generate</tt>, with file extension <tt>*.rqg</tt>.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2016
                        <a href="https://itea3.org/project/seas.html">ITEA 12004 SEAS Project</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
