<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7 at 2016-03-08 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160308" />
    <meta http-equiv="Content-Language" content="en" />
    <title>SPARQL Generate over Apache Jena &#x2013; What is SPARQL-Generate ?</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-74855518-1', 'auto');
  ga('send', 'pageview');

</script>
                      </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/thesmartenergy/sparql-generate-jena">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://itea3.org/project/seas.html" id="bannerLeft">
                                                                                        <img src="http://the-smart-energy.com/content/themes/xxi/img/logo.png"  alt="ITEA 12004 SEAS Project"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="publishDate">Last Published: 2016-03-08
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 0.10-SNAPSHOT
                      </li>
                      
              
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                              
      <li class="active">
  
            <a href="#"><span class="none"></span>Introduction</a>
          </li>
                
      <li>
  
                          <a href="examples.html" title="Examples">
          <span class="none"></span>
        Examples</a>
            </li>
                
      <li>
  
                          <a href="http://ci.emse.fr/sparql-generate/" class="externalLink" title="Specification">
          <span class="none"></span>
        Specification</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                          
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                  
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
              
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="http://github.com/thesmartenergy/sparql-generate-jena" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://cse.google.com/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>What is SPARQL-Generate ?</h1>
<p>SPARQL-Generate stands for SPARQL-Generate Protocol and RDF Generation Language. The aim of SPARQL-Generate <tt>GENERATE</tt> queries is to offer a simple template-based option to interpret any document as proper RDF, with a well defined semantics grounded on the SPARQL 1.1. </p>
<div class="section">
<h2><a name="Specification"></a>Specification</h2>
<p>The complete specification (will be) available here: <a class="externalLink" href="http://w3id.org/sparql-generate">http://w3id.org/sparql-generate</a>.</p>
<p>In the meantime, you can subscribe to the mailing list: <a class="externalLink" href="https://groups.google.com/forum/#!forum/sparql-generate-jena">https://groups.google.com/forum/#!forum/sparql-generate-jena</a>.</p></div>
<div class="section">
<h2><a name="What_use_cases_for_SPARQL-Generate_"></a>What use cases for SPARQL-Generate ?</h2>
<p>SPARQL-Generate is already in use for the following use cases:</p>

<ul>
  
<li>Give ways to interpret JSON or even CBOR documents as RDF (ongoing work in the ITEA 2 SEAS project: serve the consumption data of the GECAD microgrid as CBOR, and point to the SPARQL-Generate <tt>GENERATE</tt> query that enables to interpret it as RDF. More generally, any kind of document, XML, JSON, CBOR, can be interpreted as RDF using the proper SPARQL-Generate <tt>GENERATE</tt> query with proper <i>iterator functions</i>)</li>
  
<li>Generate a whole part of a vocabulary from a configuration file, and ensure that specific naming conventions are respected for resource URIs, labels and comments (ongoing work in the ITEA 2 SEAS project: the ontology of Multi-Dimensional Quantities, is parametrized and generated from JSON configuration files);</li>
  
<li>generate RDF from several open data sources (ongoing work in the OpenSensingCity French ANR project)</li>
</ul>
<h1>The Protocol</h1>
<p>The protocol part of SPARQL-Generate enables a web client or a web server to point to the IRI of a SPARQL-Generate document that may be used to interpret the request (or the response) payload as RDF.</p></div>
<div class="section">
<h2><a name="IANA_considerations."></a>IANA considerations.</h2>
<p>The Internet Media type of a SPARQL-Generate query is <tt>application/sparql-generate</tt>, with file extension <tt>*.rqg</tt>.</p></div>
<div class="section">
<h2><a name="aHow_you_server_should_interpret_my_lightweight_HTTP_request_payload_as_a_RDF_Graph"></a>&#x201c;How you, server, should interpret my lightweight HTTP request payload as a RDF Graph&#x201d;</h2>
<p>This protocol enables HTTP clients to be lightweight, and let servers interpret their requests body as RDF Graphs:</p>
<p>If:</p>

<ol style="list-style-type: decimal">
  
<li>client sets:
  
<ol style="list-style-type: decimal">
    
<li>HTTP Request Header Field <tt>Content-Type</tt> to IRI <tt>ct</tt>;</li>
    
<li>HTTP Request Header Field <tt>RDF-Query</tt> to IRI <tt>url</tt>;</li>
    
<li>HTTP Request Header Field <tt>RDF-Variable</tt> to string <tt>var</tt>;</li>
    
<li>HTTP Request Body <tt>body</tt>;</li>
  </ol></li>
  
<li>server operates a HTTP GET at IRI <tt>url</tt>, with Accept Field <tt>application/sparql-generate</tt>;
  
<ol style="list-style-type: decimal">
    
<li>the response header has <tt>Content-Type : application/sparql-generate</tt>;</li>
    
<li>and the response body is a valid SPARQL-Generate query <tt>query</tt>;</li>
  </ol></li>
  
<li>RDF Graph <tt>G</tt> is generated by the execution of request <tt>query</tt> with variable <tt>var</tt> being initially bound to RDF literal:
  
<ol style="list-style-type: decimal">
    
<li>with lexical form <tt>body</tt>;</li>
    
<li>with datatype URI is the concatenation of <tt>urn:iana:mime:</tt> and <tt>ct</tt>.</li>
  </ol></li>
</ol>
<p>Then, the client <i>believes</i> that <tt>G</tt> is an equivalent resource representation of its request.</p></div>
<div class="section">
<h2><a name="aHow_you_client_should_interpret_my_lightweight_HTTP_response_payload_as_a_RDF_Graph"></a>&#x201c;How you, client, should interpret my lightweight HTTP response payload as a RDF Graph&#x201d;</h2>
<p>This protocol enables HTTP servers to be lightweight, and let clients interpret their response body as RDF Graphs:</p>
<p>If:</p>

<ol style="list-style-type: decimal">
  
<li>server sets:
  
<ol style="list-style-type: decimal">
    
<li>HTTP Request Header Field <tt>Link</tt> (a web-link) with:
    
<ol style="list-style-type: decimal">
      
<li>context is the originally requested IRI;</li>
      
<li>link relation is <a class="externalLink" href="http://w3id.org/sparql-generate#query">http://w3id.org/sparql-generate#query</a>;</li>
      
<li>target IRI is <tt>url</tt>;</li>
      
<li>target attribute <tt>var</tt> is set to <tt>v</tt>;</li>
    </ol></li>
    
<li>HTTP Response Header Field <tt>Content-Type</tt> to IRI <tt>ct</tt>;</li>
    
<li>HTTP Response Body <tt>body</tt>;</li>
  </ol></li>
  
<li>client operates a HTTP GET at IRI <tt>url</tt>, with Accept Field <tt>application/sparql-generate</tt>;
  
<ol style="list-style-type: decimal">
    
<li>the response header has <tt>Content-Type : application/sparql-generate</tt>;</li>
    
<li>and the response body is a valid SPARQL-Generate query <tt>query</tt>;</li>
  </ol></li>
  
<li>RDF Graph <tt>G</tt> is generated by the execution of request <tt>query</tt> with variable <tt>v</tt> being initially bound to RDF literal:
  
<ol style="list-style-type: decimal">
    
<li>with lexical form <tt>body</tt>;</li>
    
<li>with datatype URI is the concatenation of <tt>urn:iana:mime:</tt> and <tt>ct</tt>.</li>
  </ol></li>
</ol>
<p>Then, the server <i>believes</i> that <tt>G</tt> is an equivalent resource representation of its response.</p>
<p>Below is an example of such a web-link:</p>

<div class="source">
<div class="source"><pre class="prettyprint">Link: &lt;http://manufacturer.com/deviceX/sparql-gen&gt;; rel=&quot;http://w3id.org/sparql-generate/companion&quot;; var=&quot;message&quot;
</pre></div></div>
<h1>The RDF Generation Language</h1>
<p>The RDF Generation Language part of SPARQL-Generate extends the SPARQL 1.1 Query language, and offers a simple template-based RDF Graph generation from RDF literals. </p>
<p>Other languages enable to describe mapping from documents to RDF. By design, SPARQL-Generate extends SPARQL and hence offers an alternative that presents the following advantages:</p>

<ul>
  
<li>anyone familiar with SPARQL can easily learn SPARQL-Generate;</li>
  
<li>implementing over existing SPARQL engines is simple;</li>
  
<li>SPARQL-Generate leverages the expressivity of SPARQL 1.1: Aggregates, Solution Sequences and Modifiers, SPARQL functions and their extension mechanism.</li>
</ul>
<p>SPARQL-Generate <tt>GENERATE</tt> extends the SPARQL 1.1 recommendation with the following keywords:</p></div>
<div class="section">
<h2><a name="General_form_of_a_SPARQL_Generate_Query"></a>General form of a SPARQL Generate Query</h2>
<p>The general structure of a SPARQL-Generate query is as follows:</p>

<div class="source">
<div class="source"><pre class="prettyprint">PREFIX declarations            -- same as SPARQL 1.1
GENERATE template              -- replaces and extends SPARQL 1.1 CONSTRUCT
FROM and FROM NAMED clauses    -- same as SPARQL 1.1
ITERATOR and SOURCE clauses    -- see below
WHERE clause                   -- same as SPARQL 1.1
Solution modifiers              -- group by, order by, limit, offset,... same as SPARQL 1.1
</pre></div></div></div>
<div class="section">
<h2><a name="ITERATOR_clause"></a><tt>ITERATOR</tt> clause</h2>
<p>The <tt>ITERATOR</tt> clause uses the concept of SPARQL-Generate <i>iterator function</i>. A SPARQL-Generate <i>iterator</i> is similar to a SPARQL 1.1 Function, except it <i>returns a list of RDF Terms</i> instead of just one. The syntax of the <tt>ITERATOR</tt>clause is the following:</p>

<div class="source">
<div class="source"><pre class="prettyprint">ITERATOR &lt;iterator&gt;(args) AS ?var
</pre></div></div>
<p>where <tt>&lt;iterator&gt;</tt> is the IRI of the SPARQL-Generate <i>iterator function</i>. As the name <tt>ITERATOR</tt> suggests, <tt>?var</tt> will be bound to every RDF Term in the list returned by the evaluation of the iterator function over the arguments <tt>args</tt>.</p>
<p>As a simple example, consider the JSON message:</p>

<div class="source">
<div class="source"><pre class="prettyprint">{ &quot;firstname&quot; : &quot;Maxime&quot; ,
  &quot;lastname&quot; : &quot;Lefrancois&quot; ,
  &quot;birthday&quot; : &quot;04-26&quot; ,
  &quot;country&quot; : &quot;FR&quot; 
}
</pre></div></div>
<p>The execution of the following SPARQL-Generate query,</p>

<div class="source">
<div class="source"><pre class="prettyprint">BASE &lt;http://example.org/&gt;
GENERATE 
  { &lt;&gt; ?p ?o . }
ITERATOR &lt;http://w3id.org/sparql-generate/ite/JSONListKeys&gt;(?doc) AS ?key
WHERE
  { 
    BIND( uri( ?key ) AS ?p )
    BIND( &lt;http://w3id.org/sparql-generate/fn/JSONPath&gt; ( ?doc, CONCAT( &quot;$.&quot; , ?key ) ) AS ?o )
  }
</pre></div></div>
<p>with initial binding of variable ?doc to the following RDF literal,</p>

<div class="source">
<div class="source"><pre class="prettyprint">?doc = &quot;&quot;&quot;{ &quot;firstname&quot; : &quot;Maxime&quot; ,
            &quot;lastname&quot; : &quot;Lefrancois&quot; ,
            &quot;birthday&quot; : &quot;04-26&quot; ,
            &quot;country&quot; : &quot;FR&quot;
          }&quot;&quot;&quot;^^&lt;urn:iana:mime:sparql-generate&gt;
</pre></div></div>
<p>will generate the following RDF Graph:</p>

<div class="source">
<div class="source"><pre class="prettyprint">@base &lt;http://example.org/&gt; .
&lt;&gt;      &lt;firstname&gt; &quot;Maxime&quot; ;
        &lt;lastname&gt;  &quot;Lefrancois&quot; ;
        &lt;birthday&gt;  &quot;04/26&quot; ;
        &lt;country&gt;   &quot;FR&quot; .
</pre></div></div></div>
<div class="section">
<h2><a name="SOURCE_clause"></a><tt>SOURCE</tt> clause</h2>
<p>The <tt>SOURCE</tt> clause enables to fetch a web document, and to bind it as a RDF Literal to a variable. Its syntax is as follows:</p>

<div class="source">
<div class="source"><pre class="prettyprint">SOURCE &lt;source&gt; ACCEPT &lt;iana urn&gt; AS ?var
</pre></div></div>
<p>If <tt>&lt;source&gt;</tt> is a HTTP IRI, then the engine will operate a HTTP GET to that IRI (or use a local cache), then bind variable <tt>?var</tt> to the RDF Literal representation of the retrieved document. </p>
<p><tt>ACCEPT &lt;iana urn&gt;</tt> is optional. If set, it must be a IANA MIME URN. For instance: <tt>&lt;urn:iana:mime:application/json&gt;</tt>. It tells the engine which Accept Header field to use when operating the GET.</p>
<p>The RDF Literal representation of the retrieved document is as follows:</p>

<ul>
  
<li>its lexical form is a Unicode representation of the payload;</li>
  
<li>its datatype IRI is a IANA MIME URN, based on the internet media type of the retrieved document. For instance, if the mime type is &#x201c;application/vcard+json&#x201d;. Then the datatype IRI will be <tt>&lt;urn:iana:mime:application:vcard+json&gt;</tt>. If the Content-Type is not defined in the response, then the datatype IRI is <tt>xsd:string</tt>.</li>
</ul>
<p>For example, the following SPARQL-Generate query retrieves the document at IRI <a class="externalLink" href="http://country.io/capital.json">http://country.io/capital.json</a>, then generates a little RDF description of the country code and the capital name of the two first countries whose code starts with an &#x2018;F&#x2019;.</p>

<div class="source">
<div class="source"><pre class="prettyprint">BASE &lt;http://example.org/&gt; 
GENERATE { 
  [] a &lt;Country&gt; ;
    &lt;key&gt; ?key ;
    &lt;capital&gt; ?capital.
}
SOURCE &lt;http://country.io/capital.json&gt; AS ?source
ITERATOR &lt;http://w3id.org/sparql-generate/ite/JSONListKeys&gt;(?source) AS ?key
WHERE {
   FILTER( STRSTARTS(?key,&quot;F&quot;) )
   BIND( CONCAT('$.', ?key) AS ?query )
   BIND( &lt;http://w3id.org/sparql-generate/fn/JSONPath&gt;(?source, ?query ) AS ?capital )
}
ORDER BY ?key
LIMIT 2
</pre></div></div>
<p>It generates the following RDF Graph:</p>

<div class="source">
<div class="source"><pre class="prettyprint">@base &lt;http://example.org/&gt; .
[] a          &lt;Country&gt; ;
   &lt;capital&gt;  &quot;Suva&quot; ;
   &lt;code&gt;     &quot;FJ&quot; .
[] a  &lt;Country&gt; ;
   &lt;capital&gt;  &quot;Stanley&quot; ;
   &lt;code&gt;     &quot;FK&quot; .
[] a          &lt;Country&gt; ;
   &lt;capital&gt;  &quot;Helsinki&quot; ;
   &lt;code&gt;     &quot;FI&quot; .
</pre></div></div></div>
<div class="section">
<h2><a name="sub-GENERATE_queries"></a>sub-<tt>GENERATE</tt> queries</h2>
<p>One may embed other GENERATE queries in the <tt>GENERATE</tt> template. The <tt>GENERATE</tt> part of the embedded query may be a template as above, or just a URI that indicates the engine that it must fetch and execute an existing query on the web, with the current binding solutions.</p></div>
<div class="section">
<h2><a name="How_it_works"></a>How it works</h2>
<p>To put it simply, the execution of a SPARQL Generate is defined as follows:</p>

<ol style="list-style-type: decimal">
  
<li>clauses <tt>ITERATOR</tt> and <tt>SOURCE</tt> are processed in order, and one constructs a [https://www.w3.org/TR/sparql11-query/#inline-data](SPARQL 1.1 VALUES) data block.</li>
  
<li>one constructs a SPARQL 1.1 <tt>SELECT *</tt> query from the SPARQL Generate query, and add the data block at the beginning of the WHERE clause.</li>
  
<li>this SPARQL 1.1 SELECT query is evaluated on the SPARQL dataset, and produces a set of solution bindings.</li>
  
<li>for each of these solution bindings, and for each element in the GENERATE template, one either produce triples, or execute the embedded query.</li>
</ol></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2016
                        <a href="https://itea3.org/project/seas.html">ITEA 12004 SEAS Project</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
