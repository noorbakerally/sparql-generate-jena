<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7 at 2016-03-07 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160307" />
    <meta http-equiv="Content-Language" content="en" />
    <title>SPARQL Generate over Apache Jena &#x2013; Get Started</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/thesmartenergy/sparql-generate-jena">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="https://itea3.org/project/seas.html" id="bannerLeft">
                                                                                        <img src="http://the-smart-energy.com/content/themes/xxi/img/logo.png"  alt="ITEA 12004 SEAS Project"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="publishDate">Last Published: 2016-03-07
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 0.9
                      </li>
                      
              
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                              
      <li>
  
                          <a href="index.html" title="Introduction">
          <span class="none"></span>
        Introduction</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>Examples</a>
          </li>
                
      <li>
  
                          <a href="http://ci.emse.fr/sparql-generate/" class="externalLink" title="Specification">
          <span class="none"></span>
        Specification</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                          
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                  
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
              
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="http://github.com/thesmartenergy/sparql-generate-jena" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://cse.google.com/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Get Started</h1>
<p><tt>sparql-generate-jena</tt> is an implementation of SPARQL-Generate over Apache Jena.</p>
<div class="section">
<h2><a name="Release_of_version_0.9:"></a>Release of version 0.9:</h2>
<p>Version 0.9 is released to Maven central and can be used as a dependency to your maven project: the most simple is to add the following maven dependency in your Java maven project file ( <tt>*.pom</tt> file):</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;dependency&gt;
    &lt;groupId&gt;com.github.thesmartenergy&lt;/groupId&gt;
    &lt;artifactId&gt;sparql-generate-jena&lt;/artifactId&gt;
    &lt;version&gt;0.9&lt;/version&gt;
&lt;/dependency&gt;
</pre></div></div>
<p>Version 0.9 implements:</p>

<ul>
  
<li>keywords <tt>GENERATE</tt> and <tt>ITERATOR</tt>;</li>
  
<li>sub-GENERATE queries &#x2013;&gt; URI or Template;</li>
  
<li>The following iterator functions:
  
<ul>
    
<li>List the keys of a JSON object: <a class="externalLink" href="http://w3id.org/sparql-generate/ite/JSONListKeys">http://w3id.org/sparql-generate/ite/JSONListKeys</a></li>
    
<li>JSON Path: <a class="externalLink" href="http://w3id.org/sparql-generate/ite/JSONPath">http://w3id.org/sparql-generate/ite/JSONPath</a></li>
    
<li>XPath: <a class="externalLink" href="http://w3id.org/sparql-generate/ite/XPath">http://w3id.org/sparql-generate/ite/XPath</a></li>
  </ul></li>
  
<li>The follownig custom SPARQL functions:
  
<ul>
    
<li>JSON Path: <a class="externalLink" href="http://w3id.org/sparql-generate/fn/JSONPath">http://w3id.org/sparql-generate/fn/JSONPath</a></li>
    
<li>XPath: <a class="externalLink" href="http://w3id.org/sparql-generate/fn/XPath">http://w3id.org/sparql-generate/fn/XPath</a></li>
  </ul></li>
</ul>
<p>The code is well documented and the javadoc contains description and examples of the main classes and methods. See <a class="externalLink" href="http://thesmartenergy.github.io/sparql-generate-jena/apidocs/index.html">http://thesmartenergy.github.io/sparql-generate-jena/apidocs/index.html</a> </p></div>
<div class="section">
<h2><a name="Code_examples"></a>Code examples</h2>
<p>The following sections illustrate some of the capabilities of <tt>sparql-generate-jena-0.9</tt></p>
<div class="section">
<h3><a name="Parsing_a_Query"></a>Parsing a Query</h3>

<div class="source">
<div class="source"><pre class="prettyprint"> String queryString = &quot;PREFIX ... GENERATE {...} FROM ... SOURCE ... ITERATOR ... WHERE {...}&quot;;
 Syntax syntax = SPARQLGenerate.SYNTAX;
 SPARQLGenerateQuery query = (SPARQLGenerateQuery) QueryFactory.create(queryString, syntax);
</pre></div></div></div>
<div class="section">
<h3><a name="Classes_PlanFactory_and_RootPlan"></a>Classes <tt>PlanFactory</tt> and <tt>RootPlan</tt></h3>
<p>First use an instance of <tt>PlanFactory</tt> to instantiate a <tt>RootPlan</tt> for a SPARQL-Generate query.</p>

<div class="source">
<div class="source"><pre class="prettyprint">SPARQLGenerateQuery query;
PlanFactory factory = new PlanFactory();
RootPlan plan = factory.create(query);
</pre></div></div>
<p>Then the <tt>RootPlan</tt> can be executed several times on different SPARQL datasets, and with different initial bindings (i.e., on multiple <i>messages</i>). Call one of the <tt>exec</tt> methods to trigger the RDF generation. Here is the signature of two of these methods:</p>

<div class="source">
<div class="source"><pre class="prettyprint">Model exec();
void exec(Model inputModel, QuerySolution initialBindings, Model initialModel);
void exec(Dataset inputDataset, QuerySolution initialBindings, Model initialModel);
</pre></div></div></div>
<div class="section">
<h3><a name="Retrieving_the_generated_RDF"></a>Retrieving the generated RDF</h3>
<p>RDF generated by the execution plan is added to a <tt>Model</tt>, which is the Jena class for a RDF Graph.</p>

<ul>
  
<li>some <tt>exec</tt> methods create a new model from scratch at execution time, fill it with the generated triples, and return it to the caller;</li>
  
<li>other method use parameter <tt>initialModel</tt>, and add triples.</li>
</ul>
<p>To instantiate a <tt>Model</tt>, which is the Jena model for a RDF Graph, one may use:</p>

<div class="source">
<div class="source"><pre class="prettyprint">ModelFactory.createDefaultModel();
</pre></div></div></div>
<div class="section">
<h3><a name="Evaluating_a_query_over_a_SPARQL_Dataset"></a>Evaluating a query over a SPARQL Dataset</h3>
<p>Part of the SPARQL GENERATE query execution consists in evaluating a SPARQL 1.1 <tt>SELECT *</tt> query over a RDF Graph, or a SPARQL Dataset. Exactly like in SPARQL 1.1. The corresponding parameters are <tt>inputModel</tt> or <tt>inputDataset</tt>. To instantiate a <tt>Dataset</tt>, which is the Jena class for a SPARQL Dataset, one may use:</p>

<div class="source">
<div class="source"><pre class="prettyprint">DatasetFactory.create(Model);
</pre></div></div>
<p>Note:</p>

<ul>
  
<li>If <tt>initialModel == null</tt>, then an <tt>IllegalArgumentException</tt> exception will be thrown;</li>
  
<li>The behaviour when the same instance is passed as <tt>inputModel</tt> and <tt>initialModel</tt> is not specified.</li>
</ul></div>
<div class="section">
<h3><a name="Generating_RDF_for_streams_of_messages"></a>Generating RDF for streams of messages</h3>
<p>Finally, one may execute the query with initial bindings. This is useful when one wants to apply the same plan to generate RDF from multiple messages regularly received from a lightweight sensor for instance. </p>
<p>Suppose one needs to execute a plan with a variable <tt>?msg</tt> bound to a message with textual representation <tt>&quot;mymessage&quot;</tt>and internet media-type <i>application/json</i>. Then the RDF literal to bind to <tt>?msg</tt>:</p>

<ul>
  
<li>has lexical form <tt>&quot;mymessage&quot;</tt></li>
  
<li>has datatype IRI <tt>&lt;urn:iana:mime:application/json&gt;</tt></li>
</ul>
<p>In SPARQL Generate over Apache Jena, one calls an <tt>exec</tt> method with parameter <tt>initialBindings</tt>. The following code shows how this can be done with the plan instantiated above:</p>

<div class="source">
<div class="source"><pre class="prettyprint">String variable = &quot;msg&quot;;
String message = &quot;mymessage&quot;;
String uri = &quot;urn:iana:mime:application/json&quot;;

QuerySolution initialBinding = new QuerySolutionMap();
Model initialModel = ModelFactory.createDefaultModel();

TypeMapper typeMapper = TypeMapper.getInstance();
RDFDatatype dt = typeMapper.getSafeTypeByName(uri);
Node arqLiteral = NodeFactory.createLiteral(message, dt);
RDFNode jenaLiteral = initialModel.asRDFNode(arqLiteral);
initialBindings.put(variable, jenaLiteral);

plan.exec(initialBinding, initialModel);
</pre></div></div></div>
<div class="section">
<h3><a name="Using_a_File_Manager"></a>Using a File Manager</h3>
<p>In many use cases, it is useful to use local files instead of operating HTTP GET requests. The Jena FileManager is designed just for that. It uses a configuration file to load files from disk instead of attempting HTTP GET calls. See [https://jena.apache.org/documentation/notes/file-manager.html](The Jena FileManager and LocationMapper). The following code illustrates how a <tt>FileManager</tt> can be passed to the constructor of a <tt>PlanFactory</tt>, in order to be used during the execution of the plans this <tt>PlanFactory</tt> will create.</p>

<div class="source">
<div class="source"><pre class="prettyprint">Model conf = RDFDataMgr.loadModel(&quot;file:/path/to/configuration.ttl&quot;);
LocationMapper mapper = new LocationMapper(conf);
FileManager fm = new FileManager();

fm.setLocationMapper(mapper);

Locator loc = new LocatorFile(&quot;file:/path/to/directory1&quot;);
Locator loc = new LocatorFile(&quot;file:/path/to/directory2&quot;);
fm.addLocator(loc);

PlanFactory factory = new PlanFactory(fm);
...

</pre></div></div></div></div>
<div class="section">
<h2><a name="Contribute_to_sparql-generate-jena"></a>Contribute to sparql-generate-jena</h2>
<p>We are currently in the process of debugging and writing multiple unit tests. Do not hesitate to propose tests, additions, report bugs, or just say hello:</p>

<ul>
  
<li>The issue tracker - <a class="externalLink" href="http://github.com/thesmartenergy/sparql-generate-jena/issues">http://github.com/thesmartenergy/sparql-generate-jena/issues</a></li>
  
<li>The mailing list - <a class="externalLink" href="https://groups.google.com/forum/#!forum/sparql-generate-jena">https://groups.google.com/forum/#!forum/sparql-generate-jena</a></li>
</ul></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2016
                        <a href="https://itea3.org/project/seas.html">ITEA 12004 SEAS Project</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
